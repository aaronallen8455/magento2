<?php
/**
 * Copyright Â© 2016 Magento. All rights reserved.
 * See COPYING.txt for license details.
 */

/**
 * Product Chooser for "Product Link" Cms Widget Plugin
 */
namespace AAllen\Showcase\Block\Product\Widget;

use Magento\Backend\Block\Template;
use Magento\CatalogWidget\Block\Product\Widget\Conditions;
use Magento\Framework\Data\Form\Element\AbstractElement;
use Magento\Framework\Data\Form\Element\Renderer\RendererInterface;

/**
 * Class MultiConditions
 */
class MultiConditions2 extends Conditions implements RendererInterface
{
    protected function _construct()
    {
        $this->rule->getConditions()->setData('id', 2);
        //parent::_construct(); // TODO: Change the autogenerated stub

        $widget = $this->registry->registry('current_widget_instance');
        if ($widget) {
            $widgetParameters = $widget->getWidgetParameters();
            if (isset($widgetParameters['conditions'])) {
                $widgetParameters['conditions'] = [1 => $widgetParameters['conditions'][2], '1--1' => $widgetParameters['conditions']['2--1']];
                $this->rule->loadPost($widgetParameters);
            }
        }
    }

    /**
     * @return string
     */
    public function getInputHtml()
    {

        $widget = $this->registry->registry('current_widget_instance');
        if ($widget)
            \Zend_Debug::dump($widget->getWidgetParameters());
        $this->rule->getConditions()->setData('id', 2);

        /** @var AbstractElement input */
        $this->input = $this->elementFactory->create('text');
        $this->input->setRule($this->rule)->setRenderer($this->conditions);
        return $this->input->toHtml();
    }
}
